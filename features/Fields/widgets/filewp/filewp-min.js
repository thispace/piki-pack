!function($){window.startFileWP=function(){$(".field-item > div.ftype-filewp").fileWpField()},pikiforms_init_methods.push("window.startFileWP"),$.fn.fileWpField=function(method){var pluginArgs=arguments;return this.each(function(){var field=this,$this=$(this);this.configure=function(){this.target=$("input.filewp-ids",$this).first(),this.select=$("input.filewp-select-button",$this).first(),this.edit=$("input.filewp-edit-button",$this).first(),this.remove=$("input.filewp-remove-button",$this).first(),this.label=$("input.filewp-upload-label",$this).first().val(),this.thumbs=$("div.filewp-media-thumbs",$this).first(),this.status=$("div.filewp-media-status",$this).first(),this.multiple=void 0!=$this.attr("--multiple")&&"on"==$this.attr("--multiple"),this.thumbs.on("click","a.remove",function(t){t.preventDefault(),field.removeFileItem($(this))}),this.multiple&&(this.thumbs.sortable({items:"div.thumbnail",stop:function(t,i){field.alignValues()}}),this.thumbs.disableSelection()),this.wpmedia=wp.media.frames.customHeader=wp.media({title:field.select.val(),button:{text:field.select.val()},multiple:void 0!==$this.attr("--multiple")&&"on"===$this.attr("--multiple")?!0:!1}),this.wpmedia.on("select",function(){var t=field.wpmedia.state().get("selection");field.returnFile(t)}),this.select.on("click",function(t){t.preventDefault(),field.wpmedia.open()}),this.edit.on("click",function(t){t.preventDefault(),field.wpmedia.open()}),this.remove.on("click",function(t){t.preventDefault(),field.removeValues(),field.remove.hide(),field.edit.hide(),field.select.show()}),this.ready=!0},this.alignValues=function(){var t=[];this.thumbs.children().each(function(){t.push($(this).attr("rel"))}),this.target.val(t.join(","))},this.returnFile=function(t){this.remove.show(),this.multiple?(field.edit.hide(),field.select.show()):(this.removeValues(),field.edit.show(),field.select.hide());var i=field.target.val();console.info("values"),console.log(i),i=""===i?[]:i.split(","),t.map(function(t){t=t.toJSON(),i.push(t.id);var e=$('<div class="thumbnail" rel="'+t.id+'"></div>');e.html('<img src="'+t.icon+'" alt="'+t.title+'" /><a href="'+t.url+'" rel="'+t.id+'" target="_blank" class="action preview" title="'+t.title+'">Visualizar arquivo</a><a rel="'+t.id+'" class="action remove" title="Remover">Remover arquivo</a>'),field.thumbs.stop(!0,!0).show(),e.hide().prependTo(field.thumbs).fadeIn(400)}),field.target.val(i.join(","))},this.removeValues=function(){this.thumbs.length&&this.thumbs.stop(!0,!0).hide().html(""),this.target.val("")},this.removeFileItem=function(t){var i=t.attr("rel"),e=this.target.val().split(","),l=[];$.each(e,function(t,e){e!==i&&l.push(e)}),this.target.val(l.join(",")),t.parent().fadeOut(250,function(){$(this).remove()})};var toCall;if(void 0==(toCall=eval("this."+method))){if(this.ready)return;this.configure.apply(this,pluginArgs)}else toCall.apply(this,Array.prototype.slice.call(pluginArgs,1))})}}(jQuery);